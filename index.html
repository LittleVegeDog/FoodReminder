<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta charset="UTF-8">
<title>Hamilton Impression</title>
<link rel="shortcut icon" href="pic/favicon.ico">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" >
<style>
.navi{
  background-color: #003333;
  margin: 0;
  padding: 5px;
  overflow: hidden;
  list-style-type: none;
  top:0;
  left:0;
  position:absolute;
  width: 100%;
}

.navii{
  float: left;
  width: 15%;
}

.navii a {
  display: block;
  color: white;
  text-align: center;
  padding: 12px 30px;
  text-decoration: none;
}

.navii:hover {
  background-color: #181818;
}
a:active {
  color: red;
}
#CreateReviewPage {
	top: 90px;
	width: 100%;
	position: relative;
	bottom:0;
	overflow: hidden;
}

#restaurantNameInput, #foodNameInput, #foodPriceInput, #restaurantTeleInput{
	width: 50%
	
}

#registeredRestaurants{
	width: 50%
}

#foodCuisineInput{
	width: 30%
}

#ratingRadioButtonsField{
	width: 35%
	
}


#SearchRestaurantPage {
	top: 90px;
	width: 100%;
	position: relative;
	bottom:0;
	overflow: hidden;
}

#searchRestMethodInput{
	width: 65%;


}
#lastAttendedInput{
	width:45%
}


</style>
</head>
<body style="background-color:#97D077;">
<div id="navig"> 
<!--navigation bar with 4 elements-->
<ul class="navi">
  <li class="navii" id="homeNav" style="background-color:#003333;"><a href="#"><img src="picture/logo.png" alt="logo" style="width:70%"></a></li>
  <li class="navii" id="createReviewNav" style="background-color:#181818;"><a href="#createReview">Create Review</a></li>
  <li class="navii" id="browseReviewNav"><a href="#browseReviews">Browser Review</a></li>
  <li class="navii" id="searchRestaurantNav"><a href="#searchRestaurant">Search Restaurant</a></li>
</ul>
</div>

<!-- Create Review Page HTML -->

<div id="CreateReviewPage" class = "container-lg" style="display:none">

	<h1 style = "text-align: left"> Create New Food Review </h1>
	
	<form>
		<div class="row">
			<div class="col-lg">
			
				<div class="form-group" id = "registeredRestaurantsDiv" style="display:block">
					<label for="registeredRestaurants" class="form-control-label">Choose From Registered Restaurant Or Register New Restaurant:</label>
					<select name="registeredRestaurants" id="registeredRestaurants" class="custom-select">
							
					</select>
				</div>
				
				<div class="form-group" id = "restaurantNameInputDiv" style="display:None">
					<label for="restaurantNameInput" class="form-control-label">New Restaurant Name:</label>
					<input type="text" class="form-control" id="restaurantNameInput">
					<div id="restaurantNameInputFeedback" class="invalid-feedback"></div>
				</div>
				
				<div class="form-group">
					<label for="foodNameInput" class="form-control-label">Food Name:</label>
					<input type="text" class="form-control" id="foodNameInput">
					<div id="foodNameInputFeedback" class="invalid-feedback"> </div>
				</div>
				
				<div class="form-group">
					<label for="foodPriceInput" class="form-control-label">Price(In CAD):</label>
					<input type="number" min="1" step="0.1" class="form-control" id="foodPriceInput">
					<div id="foodPriceInputFeedback" class="invalid-feedback"> </div>
				</div>
		
				<div class="form-group">
					<label for="foodCommentInput" class="form-control-label">Comment:</label>
					<input type="text" class="form-control" id="foodCommentInput">
					<div id="foodCommentInputFeedback" class="invalid-feedback"> </div>
				</div>
				
				<div class="form-group">
					<label for="foodCuisineInput" class="form-control-label">Cuisine:</label>
					<select name="foodCuisineInput" id="foodCuisineInput" class="custom-select">
						<option value="Unknown">Unknown</option>
						<option value="Chinese">Chinese</option>
						<option value="FastFood">Fast Food</option>
						<option value="Germany">Germany</option>
						<option value="Indian">Indian</option>
						<option value="Italian">Italian</option>
						<option value="Japanese">Japanese</option>
						<option value="Mexican">Mexican</option>
						<option value="MiddleEastern">Middle Eastern</option>
					</select>
				</div>
				
				<div class= "reviewRatingButtons">
					<fieldset id="ratingRadioButtonsField">
						<legend>Rate the food: </legend>
						<input type="radio" id="ratingFive" value="5" name="ratingButton" checked>
						<label for="ratingFive" >Tastes Very Good</label><br>
						<input type="radio" id="ratingFour" value="4" name="ratingButton">
						<label for="ratingFour">Tastes Good</label><br>
						<input type="radio" id="ratingThree" value="3" name="ratingButton">
						<label for="ratingThree">Teastes Normal</label><br>
						<input type="radio" id="ratingTwo" value="2" name="ratingButton">
						<label for="ratingTwo">Tastes Bad</label><br>
						<input type="radio" id="ratingOne" value="1" name="ratingButton">
						<label for="ratingOne">Tastes Very Bad</label><br>
					</fieldset>
				</div> <br/>
				<div class= "confirmCreationButtons">
					<input type="button" id="createReview" class="btn btn-primary">
					<input type="button" value="Reset" class="btn btn-secondary" id="reset">
				</div> 
    
			</div>
			<div class="col-sm"> 
				<!--<input type="file" id="avatar" name="avatar" accept="image/png, image/jpeg, image/jpg">-->
				<div class="input-group mb-3">
					<div class="custom-file">
						<input type="file" class="custom-file-input" id="foodPictureInput" accept="image/png, image/jpeg, img/jpg">
						<label class="custom-file-label" for="inputGroupFile02" aria-describedby="inputGroupFileAddon02" id="foodPictureInputLabel"></label>
					</div>
				</div>
				<span id="showPictureInput"></span> <br/>
				<div class="form-group">
					<label for="restaurantTeleInput" class="form-control-label">Restaurant's Telephone Number:</label>
					<input type="number" min="1000000000" max = "9999999999" step="1" class="form-control" id="restaurantTeleInput">
					<div id="restaurantTeleInputFeedback" class="invalid-feedback"> </div>
				</div>
			</div>
		
		</div>
	</form>
	<br/>
	<div class="alert alert-primary" style="display:none" id="status" role="alert"></div>
	<div class= "finishCreationButtons" style="display:none" id= "finishCreationButtons">
		<input type="button" value="Create Another Review" id="createAnotherReview" class="btn btn-secondary">
		<input type="button" value="Jump To Browser Review Page" class="btn btn-primary" id="toBrowseReview">
	</div> </br>
</div>

<!---->



<!-- Search Restaurant Page HTML -->

<div id="SearchRestaurantPage" class = "container-lg" style="display:None">
	<h1 style="text-align:center">Search Restaurants and Restaurants' Analysis</h1></br>
	<form>
		<div class="row">
		
			<div class="col-lg">
				<div class="form-group" id = "restaurantsInSearchDiv" style="display:block">
					<label for="restaurantsInSearch" class="form-control-label">Choose A Registered Restaurant:</label>
					<select name="restaurantsInSearch" id="restaurantsInSearch" class="custom-select">
							
					</select>
				</div>
				
				<div class="form-group" id = "avgPriceInputDiv" style="display:none">
					<label for="avgPriceInput" class="form-control-label">Enter Your Max Average Price(In CAD):</label>
					<input type="number" min="1" step="0.1" class="form-control" id="avgPriceInput">
					<div id="avgPriceInputFeedback" class="invalid-feedback"> </div>
				</div>
				
				<div class="form-group" id = "lastAttendedInputDiv" style="display:none">
					<label for="lastAttendedInput" class="form-control-label">Last Attended Date Before:</label>
					<input type="date" id="lastAttendedInput" name="lastAttendedInput" class="form-control">
					<div id="lastAttendedInputFeedback" class="invalid-feedback"> </div>
				</div>
				<input type="button" id="startSearchRestaurant" class="btn btn-primary" value="Search">
				<input type="button" id="resetSearchRestaurantPage" class="btn btn-secondary" value="Reset Analysis">

			</div>
			<div class="col-lg">
				
				<div class="form-group">
					<br/>
					<label for="searchRestMethodInput" class="form-control-label">Search Methods:</label>
					<select name="searchRestMethodInput" id="searchRestMethodInput" class="custom-select">
						<option value="Search By Restaurant's Name">Search By Restaurant's Name</option>
						<option value="Search By Restaurant's Average Price">Search By Restaurant's Average Price</option>
						<option value="Search By Last Attended Date">Search By Last Attended Date</option>
					</select>
				</div>
			</div>
		</div><br/><br/>
	</form>
	<div class="row" id="restaurantTable">
		<input type="button" id="sortRestaurantsByRate" class="btn btn-primary" value="Sort By Average Rating">
		<table class="table" >
			<thead class="thead-light">
				<tr>
					<th scope="col">Name</th>
					<th scope="col">Last Attended At</th>
					<th scope="col">Average Price</th>
					<th scope="col">Average Rating(out of 5)</th>
					<th scope="col">Contact Restaurant</th>
					<th scope="col"></th>
				</tr>
			</thead>
			<tbody id="restaurantTableBody">
			</tbody>
		</table>
	</div>

</div>

<!---->

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<script>
		var filteredRestaurants = [];
		var Restaurants = [];
		var Reviews = [];
		var mode = "NotInCreate";
		var pageNowIn = "Home";
		var newReviewID = 0;
		function getRestOptionStr(){
			optStr='<option value="newRestaurant">New Restaurant</option>';
			for (r of Restaurants){
				optStr = optStr + '<option value="' + r.name + '">' + r.name + "</option>";						
			}
			return optStr;
		}
		
		restOptStr = getRestOptionStr();
		console.log(restOptStr.length);
		
		
		document.getElementById("homeNav").onclick = function(){
			if (pageNowIn == "Home") /*no action*/return //or refresh the page;
			else {
				pageNowIn = "Home";
				document.getElementById("CreateReviewPage").style = "display:none";
				document.getElementById("SearchRestaurantPage").style = "display:none";
				//code initializes Home page 
			}
		}
		
		document.getElementById("createReviewNav").onclick = function(){
			
			if (pageNowIn == "CreateReview") return;
			else{
				pageNowIn = "CreateReview";
				mode = "InCreate";
				document.getElementById("SearchRestaurantPage").style = "display:none";
				document.getElementById("CreateReviewPage").style = "display:block";
				/*document.getElementById("foodPictureInputLabel").innerHTML= "Attatch picture of the food";
				document.getElementById("showPictureInput").innerHTML = "";
				document.getElementById("createReview").value = "Create Review";
				
				if (Restaurants.length == 0){ 
					document.getElementById("registeredRestaurantsDiv").style = "display:none";
					document.getElementById("restaurantNameInputDiv").style = "display:block";
				}
				else{
					document.getElementById("registeredRestaurantsDiv").style = "display:block";
					document.getElementById("registeredRestaurantsDiv").value = "newRestaurant";
					document.getElementById("restaurantNameInputDiv").style = "display:block";
					document.getElementById("registeredRestaurants").innerHTML = restOptStr;
				}*/
				initCreateReviewPage();
				document.getElementById("createReview").value = "Create Review";
			}
			
		}
		
		document.getElementById("browseReviewNav").onclick = function(){
			if (pageNowIn == "BroweReview") /*no action*/return //or refresh the page;
			else {
				pageNowIn = "BroweReview";
				document.getElementById("CreateReviewPage").style = "display:none";
				document.getElementById("SearchRestaurantPage").style = "display:none";
				//code initializes Browse Review page 
			}
		}
		
		document.getElementById("searchRestaurantNav").onclick = function(){
			if (pageNowIn == "SearchRestaurant") /*no action*/return //or refresh the page;
			else {
				pageNowIn = "SearchRestaurant";
				document.getElementById("CreateReviewPage").style = "display:none";
				document.getElementById("SearchRestaurantPage").style = "display:block";
				initSearchRestaurantPage();
				//code initializes Search Restaurant page 
			}
		}
		
		
		
		document.getElementById("registeredRestaurants").onchange = function(){
			if (document.getElementById("registeredRestaurants").value == "newRestaurant"){
				document.getElementById("restaurantNameInputDiv").style = "display:block";
				document.getElementById("restaurantTeleInput").value = "";
			}
			else{
				document.getElementById("restaurantNameInputDiv").style = "display:none";
				chosen = document.getElementById("registeredRestaurants").value;
				var r;
				for (r of Restaurants){
						if(r.name == chosen){
							break;
						}
					}
				document.getElementById("restaurantTeleInput").value = r.teleNum;
			}
			
		}
		
		document.getElementById("foodPictureInput").onchange = function(){
			picPath = '"' + document.getElementById("foodPictureInput").value + '"';
			lastSlash = picPath.lastIndexOf("\\");
			picName = picPath.slice(lastSlash+1, picPath.length-1)
			if (picPath == '""'){
				document.getElementById("foodPictureInputLabel").innerHTML= "Attatch picture of the food";
				document.getElementById("showPictureInput").innerHTML = "";
			}
			else {
				document.getElementById("foodPictureInputLabel").innerHTML = document.getElementById("foodPictureInput").value;
				document.getElementById("showPictureInput").innerHTML = "<img id=foodPictureSelected" + ' src= "picture/' + picName + '" width = 450 height = 450 />'
			}
		}
	  
		document.getElementById("restaurantNameInput").onkeyup = function()
		{
			restaurantName = document.getElementById("restaurantNameInput").value;
			if (restaurantName.length == 0){
				document.getElementById("restaurantNameInput").classList = "form-control is-invalid";          
				document.getElementById("restaurantNameInputFeedback").classList = "invalid-feedback";          
				document.getElementById("restaurantNameInputFeedback").innerHTML = "Please give a name of the restaurant";  
			}
			else {
				document.getElementById("restaurantNameInput").classList = "form-control is-valid";     
				document.getElementById("restaurantNameInputFeedback").classList = "valid-feedback";          
				document.getElementById("restaurantNameInputFeedback").innerHTML = "Restaurant Name Gotten!";
			}
		}
      
		document.getElementById("foodNameInput").onkeyup = function()
		{
			foodName = document.getElementById("foodNameInput").value;
			if (foodName.length == 0){
				document.getElementById("foodNameInput").classList = "form-control is-invalid";          
				document.getElementById("foodNameInputFeedback").classList = "invalid-feedback";          
				document.getElementById("foodNameInputFeedback").innerHTML = "Please give a name of the food";  
			}
			else {
				document.getElementById("foodNameInput").classList = "form-control is-valid";     
				document.getElementById("foodNameInputFeedback").classList = "valid-feedback";          
				document.getElementById("foodNameInputFeedback").innerHTML = "Food Name Gotten!";
			}
		}  

		document.getElementById("foodPriceInput").onkeyup = function()
		{
			foodPrice = document.getElementById("foodPriceInput").value;
			if (foodPrice == null){
				document.getElementById("foodPriceInput").classList = "form-control is-invalid";          
				document.getElementById("foodPriceInputFeedback").classList = "invalid-feedback";          
				document.getElementById("foodPriceInputFeedback").innerHTML = "Please give the price of the food";  
			}
			else if (foodPrice <= 0){
				document.getElementById("foodPriceInput").classList = "form-control is-invalid";     
				document.getElementById("foodPriceInputFeedback").classList = "invalid-feedback";          
				document.getElementById("foodPriceInputFeedback").innerHTML = "Price of food invalid, please give a positive number as the price.";
			}
			else {
				document.getElementById("foodPriceInput").classList = "form-control is-valid";     
				document.getElementById("foodPriceInputFeedback").classList = "valid-feedback";          
				document.getElementById("foodPriceInputFeedback").innerHTML = "Food Price Gotten!";
			}
		}
		
		document.getElementById("restaurantTeleInput").onkeyup = function()
		{
			teleNumber = document.getElementById("restaurantTeleInput").value;
			if (teleNumber == null){
				document.getElementById("restaurantTeleInput").classList = "form-control is-invalid";          
				document.getElementById("restaurantTeleInputFeedback").classList = "invalid-feedback";          
				document.getElementById("restaurantTeleInputFeedback").innerHTML = "Please enter the telephone number of the restaurant";  
			}
			else if (teleNumber < 1000000000 || teleNumber > 9999999999){
				document.getElementById("restaurantTeleInput").classList = "form-control is-invalid";     
				document.getElementById("restaurantTeleInputFeedback").classList = "invalid-feedback";          
				document.getElementById("restaurantTeleInputFeedback").innerHTML = "Phone number invalid, please enter a 10-digit phone number.";
			}
			else {
				document.getElementById("restaurantTeleInput").classList = "form-control is-valid";     
				document.getElementById("restaurantTeleInputFeedback").classList = "valid-feedback";          
				document.getElementById("restaurantTeleInputFeedback").innerHTML = "Food Price Gotten!";
			}
		}
		
		
		function initCreateReviewPage(){
		
			if (Restaurants.length == 0){ 
					document.getElementById("registeredRestaurantsDiv").style = "display:none";
					document.getElementById("registeredRestaurants").innerHTML = restOptStr;
					document.getElementById("registeredRestaurantsDiv").value = "newRestaurant";
					document.getElementById("restaurantNameInputDiv").style = "display:block";
					document.getElementById("restaurantNameInput").value = "";
					document.getElementById("restaurantNameInput").classList = "form-control";          
					document.getElementById("restaurantNameInputFeedback").classList = "invalid-feedback"; 
					document.getElementById("restaurantNameInputFeedback").innerHTML = "";
				}
			else{
					document.getElementById("registeredRestaurantsDiv").style = "display:block";
					restOptStr = getRestOptionStr();
					document.getElementById("registeredRestaurants").innerHTML = restOptStr;
					document.getElementById("registeredRestaurantsDiv").value = "newRestaurant";
					document.getElementById("restaurantNameInputDiv").style = "display:block";
					document.getElementById("restaurantNameInput").value = "";
					document.getElementById("restaurantNameInput").classList = "form-control";          
					document.getElementById("restaurantNameInputFeedback").classList = "invalid-feedback"; 
					document.getElementById("restaurantNameInputFeedback").innerHTML = "";
					
			}
			
			 
			
			document.getElementById("foodNameInput").value = "";        
			document.getElementById("foodNameInput").classList = "form-control";          
			document.getElementById("foodNameInputFeedback").classList = "invalid-feedback";          
			document.getElementById("foodNameInputFeedback").innerHTML = "";
			
			document.getElementById("foodPriceInput").value = null;        
			document.getElementById("foodPriceInput").classList = "form-control";          
			document.getElementById("foodPriceInputFeedback").classList = "invalid-feedback";          
			document.getElementById("foodPriceInputFeedback").innerHTML = "";
			
			document.getElementById("restaurantTeleInput").value = null;        
			document.getElementById("restaurantTeleInput").classList = "form-control";          
			document.getElementById("restaurantTeleInputFeedback").classList = "invalid-feedback";          
			document.getElementById("restaurantTeleInputFeedback").innerHTML = "";

			document.getElementById("foodCuisineInput").value = "Unknown";
			
			document.getElementById("foodCommentInput").value = "";        
			document.getElementById("foodCommentInput").classList = "form-control";          
			document.getElementById("foodCommentInputFeedback").classList = "invalid-feedback";          
			document.getElementById("foodCommentInputFeedback").innerHTML = "";
			
			document.getElementById("foodPictureInputLabel").innerHTML= "Attatch picture of the food";
			document.getElementById("foodPictureInput").value= null;
			document.getElementById("showPictureInput").innerHTML = "";
			
			document.getElementById("ratingFive").checked = true;
			
			document.getElementById("status").style = "display:none";
			document.getElementById("status").innerHTML = "";
			
			document.getElementById("finishCreationButtons").style = "display:none";
		}
		
		document.getElementById("reset").onclick = function()
		{	
			if(mode == "InCreate"){
				initCreateReviewPage();
				document.getElementById("createReview").value = "Create Review";
			}
			else if(mode == "FinishCreate"){
				document.getElementById("status").classList = "alert alert-danger";
				document.getElementById("status").innerHTML = "Current creation is finished! Please click one of the two buttons below to start new creation or jump to Browse Review Page.";
			}
			
			
            
		}

		document.getElementById("createReview").onclick = function()
		{
			document.getElementById("status").style = "display:block";
			
			if (mode == "InCreate"){
				if (document.getElementById("registeredRestaurants").value != "newRestaurant"){
					console.log("in select")
					restaurantName = document.getElementById("registeredRestaurants").value;
				}
				else {
					restaurantName = document.getElementById("restaurantNameInput").value;
				}
				
				restaurantTele = document.getElementById("restaurantTeleInput").value;
			
				foodName = document.getElementById("foodNameInput").value;
			
				foodPrice = document.getElementById("foodPriceInput").value;
			
				foodCuisine = document.getElementById("foodCuisineInput").value;
			
				foodComment = document.getElementById("foodCommentInput").value;
			
				ratings = document.getElementsByName("ratingButton");
			
				var foodRating;
			
				for(var i = 0; i < ratings.length; i++){
					if(ratings[i].checked){
						foodRating = ratings[i].value;
					}
				}
				if (restaurantName.length > 0 && foodName.length > 0 && foodPrice > 0 
					&& (restaurantTele == "" || (parseInt(restaurantTele) >= 1000000000 && parseInt(restaurantTele) <= 9999999999))) 
				{
					document.getElementById("status").classList = "alert alert-success";
					newReviewID++;
					var newReview = {id: newReviewID, restaurant: "", food: "", price: 0, comment: "", cuisine: "Unknown", rating: 0, picture: "", dateCreated:"" };
					newReview.restaurant = restaurantName;
					newReview.food = foodName;
					newReview.price = foodPrice;
					newReview.comment = foodComment;
					newReview.cuisine = foodCuisine;
					newReview.rating = foodRating;
					var now = new Date();
					newReview.dateCreated = now.getFullYear() + "-" + (now.getMonth()+1) + "-" + now.getDate();
					
					picPath = '"' + document.getElementById("foodPictureInput").value + '"';
					console.log(picPath);
					lastSlash = picPath.lastIndexOf("\\");
					if (picPath == '""') newReview.picture = "";
					else newReview.picture = picPath.slice(lastSlash+1, picPath.length-1);
					
					Reviews.push(newReview);
					
					notRegistered = true;
					var r;
					for (r of Restaurants){
						if(r.name == restaurantName){
							notRegistered = false;
							break;
						}
					}
					if (notRegistered) {
						newRestaurant = {name: restaurantName, 
										teleNum: restaurantTele , 
										avgRate: parseInt(foodRating), 
										avgPrice: parseInt(foodPrice),
										numOfFood: 1, 
										lastAttended: now.getFullYear() + "-" + (now.getMonth()+1) + "-" + now.getDate()}
						Restaurants.push(newRestaurant);
						
					}
					else{
						r.teleNum =  restaurantTele;
						r.avgRate = ((r.avgRate*r.numOfFood) + parseInt(foodRating))/(r.numOfFood+1);
						r.avgPrice = ((r.avgPrice*r.numOfFood) + parseInt(foodPrice))/(r.numOfFood+1);
						r.numOfFood = r.numOfFood + 1;
						r.lastAttended = '"' + now.getFullYear() + "/" + (now.getMonth()+1) + "/" + now.getDate() + '"';
					}
					
					console.log(Restaurants);
					console.log(Reviews)
				
					document.getElementById("status").innerHTML = "Review Created successfully! Create another food review or jump to Browser Review page?";
					document.getElementById("finishCreationButtons").style = "display:block";
					mode = "FinishCreate";
				
				}
				else if(restaurantName.length == 0)
				{
					document.getElementById("status").classList = "alert alert-danger";
					document.getElementById("status").innerHTML = 
					"Please give the name of the restaurant!";         
				}
				else if(foodName.length == 0)
				{
					document.getElementById("status").classList = "alert alert-danger";
					document.getElementById("status").innerHTML = 
					"Please give the name of the food!";         
				}
				else if(foodPrice == null)
				{
					document.getElementById("status").classList = "alert alert-danger";
					document.getElementById("status").innerHTML = 
					"Please give the name of the food!";         
				}
				else if(foodPrice <= 0){
					document.getElementById("status").classList = "alert alert-danger";
					document.getElementById("status").innerHTML = 
					"Food price invalid, creation of new review failed.";         
				}
				else if(restaurantTele != "" && (parseInt(restaurantTele) < 1000000000 || parseInt(restaurantTele) > 9999999999)){
					document.getElementById("status").classList = "alert alert-danger";
					document.getElementById("status").innerHTML = 
					"Restaurant phone number invalid, creation of new review failed.";
				}
			}
			else if (mode == "FinishCreate"){
				document.getElementById("status").classList = "alert alert-danger";
				document.getElementById("status").innerHTML = "Current creation is finished! Please click one of the two buttons below to start new creation or jump to Browse Review Page.";
			
			}

		}
		
		document.getElementById("createAnotherReview").onclick = function(){
			if (mode == "FinishCreate"){
				mode = "InCreate";
				initCreateReviewPage()
				document.getElementById("createReview").value = "Create Review";
				
			}
		}
		
		document.getElementById("toBrowseReview").onclick = function(){
			if (mode == "FinishCreate"){
				mode = "NotInCreate"
				pageNowIn = "BroweReview";
				document.getElementById("CreateReviewPage").style = "display:none";
				//code initializes Browse Review page 
			
			}
		
		}
		
		function genRestaurantTableStr(restaurantList){
			tableBodyStr = "";
			var r;
			for (r of restaurantList) {
				tableBodyStr = tableBodyStr
								+"<tr>"
								+'<th scope="row">'+ r.name + "</th>"
								+"<td>"+ r.lastAttended + "</td>"
								+"<td>"+ r.avgPrice + "</td>"
								+"<td>"+ r.avgRate + "</td>"
								+"<td>"+ '<a class="btn btn-primary" role="button" href="tel:' + r.teleNum + '">' + r.teleNum + "</a>" + "</td>"
								+"<td>"+ '<a class="btn btn-primary" role="button" href="https://www.ubereats.com/ca" style="font-size:small"> Jump To UberEats </a>' + "</td>"
								+"</tr>";
			}
			return tableBodyStr;
		
		}
		
		function initSearchRestaurantPage(){
			document.getElementById("avgPriceInput").value = null;
			document.getElementById("lastAttendedInput").value = null;
			
			if (Restaurants.length == 0){
				document.getElementById("searchRestMethodInput").value = "Search By Restaurant's Name";
				document.getElementById("restaurantsInSearchDiv").style = "display:block";
				document.getElementById("avgPriceInputDiv").style = "display:none";
				document.getElementById("lastAttendedInputDiv").style = "display:none";
			}
			else{
				document.getElementById("searchRestMethodInput").value = "Search By Restaurant's Name";
				document.getElementById("restaurantsInSearchDiv").style = "display:block";
				document.getElementById("avgPriceInputDiv").style = "display:none";
				document.getElementById("lastAttendedInputDiv").style = "display:none";
				Restaurants.sort(compareRestaurant);
				filteredRestaurants = [];
				for(r of Restaurants){
					console.log(r);
					let tempRestaurant= JSON.parse(JSON.stringify(r));
					filteredRestaurants.push(tempRestaurant);
				}
				restOptStr = getRestOptionStr();
				searchRestOpt = restOptStr.slice(52,restOptStr.length-1);
				document.getElementById("restaurantsInSearch").innerHTML = searchRestOpt;
				
				tableBodyStr = genRestaurantTableStr(Restaurants);
				document.getElementById("restaurantTableBody").innerHTML = tableBodyStr;
			}
		}
		
		document.getElementById("searchRestMethodInput").onchange = function(){
			if (document.getElementById("searchRestMethodInput").value == "Search By Restaurant's Name"){
				document.getElementById("restaurantsInSearchDiv").style = "display:block";
				document.getElementById("avgPriceInputDiv").style = "display:none";
				document.getElementById("lastAttendedInputDiv").style = "display:none";
			}
			else if (document.getElementById("searchRestMethodInput").value == "Search By Restaurant's Average Price"){
				document.getElementById("restaurantsInSearchDiv").style = "display:none";
				document.getElementById("avgPriceInputDiv").style = "display:block";
				document.getElementById("lastAttendedInputDiv").style = "display:none";
			}
			else{
				document.getElementById("restaurantsInSearchDiv").style = "display:none";
				document.getElementById("avgPriceInputDiv").style = "display:none";
				document.getElementById("lastAttendedInputDiv").style = "display:block";
			}
		}
		
		function compareRestaurant(restA,restB){
			if (document.getElementById("searchRestMethodInput").value == "Search By Restaurant's Name"){
				nameA = restA.name.toLowerCase();
				nameB = restB.name.toLowerCase();
				if(nameA > nameB){
					return 1;
				}
				else if(nameA < nameB){
					return -1;
				}
				else{
					if(restA.avgRate > restB.avgRate){
						return -1;
					}
					if(restA.avgRate < restB.avgRate){
						return 1;
					}
					else{return 0;}
				
				} 
			}
			else if (document.getElementById("searchRestMethodInput").value == "Search By Restaurant's Average Price"){
				if(restA.avgPrice > restB.avgPrice){
					return -1;
				}
				else if(restA.avgPrice < restB.avgPrice){
					return 1;
				}
				else{
					if(restA.avgRate > restB.avgRate){
						return -1;
					}
					if(restA.avgRate < restB.avgRate){
						return 1;
					}
					else{return 0;}
				
				} 
			}
			
			else if (document.getElementById("searchRestMethodInput").value == "Search By Last Attended Date"){
				if(restA.LastAttended > restB.LastAttended){
					return -1;
				}
				else if(restA.LastAttended < restB.LastAttended){
					return 1;
				}
				else{
					if(restA.avgRate > restB.avgRate){
						return -1;
					}
					if(restA.avgRate < restB.avgRate){
						return 1;
					}
					else{return 0;}
				
				} 	
			}
			else {return 0;}
		
		}
		
		
		document.getElementById("sortRestaurantsByRate").onclick = function(){
			if (Restaurants.length == 0){
			}
			else{
				filteredRestaurants.sort(function(restA,restB){
					if(restA.avgRate > restB.avgRate){
						return -1;
					}
					if(restA.avgRate < restB.avgRate){
						return 1;
					}
					else{return 0;}
				});
				tableBodyStr = genRestaurantTableStr(filteredRestaurants);
				document.getElementById("restaurantTableBody").innerHTML = tableBodyStr;
			}
		}
		
		document.getElementById("startSearchRestaurant").onclick = function(){
			if (document.getElementById("searchRestMethodInput").value == "Search By Restaurant's Name"){
				filterValue = document.getElementById("restaurantsInSearch").value;
				if (filterValue != ""){
					filteredRestaurants = []
					for(r of Restaurants){
						if (r.name == filterValue){
							tempRestaurant = JSON.parse(JSON.stringify(r))
							filteredRestaurants.push(tempRestaurant);
						}
					}
					filteredRestaurants.sort(compareRestaurant)
					tableBodyStr = genRestaurantTableStr(filteredRestaurants);
					document.getElementById("restaurantTableBody").innerHTML = tableBodyStr;
				}
				else{
					Restaurants.sort(compareRestaurant)
					tableBodyStr = genRestaurantTableStr(Restaurants);
					document.getElementById("restaurantTableBody").innerHTML = tableBodyStr;
				}
			}
			else if (document.getElementById("searchRestMethodInput").value == "Search By Restaurant's Average Price"){
				filterValue = document.getElementById("avgPriceInput").value;
				if (filterValue != ""){
					filteredRestaurants = []
					for(r of Restaurants){
						if (r.avgPrice <= filterValue){
							tempRestaurant = JSON.parse(JSON.stringify(r))
							filteredRestaurants.push(tempRestaurant);
						}
					}
					filteredRestaurants.sort(compareRestaurant)
					tableBodyStr = genRestaurantTableStr(filteredRestaurants);
					document.getElementById("restaurantTableBody").innerHTML = tableBodyStr;
				}
				else{
					Restaurants.sort(compareRestaurant)
					tableBodyStr = genRestaurantTableStr(Restaurants);
					document.getElementById("restaurantTableBody").innerHTML = tableBodyStr;
				}
			}
			else if(document.getElementById("searchRestMethodInput").value == "Search By Last Attended Date"){
				document.getElementById("lastAttendedInputDiv").style = "display:block";
				filterValue = document.getElementById("lastAttendedInput").value;
				if (filterValue != ""){
					filteredRestaurants = []
					for(r of Restaurants){
						if (r.lastAttended <= filterValue){
							tempRestaurant = JSON.parse(JSON.stringify(r))
							filteredRestaurants.push(tempRestaurant);
						}
					}
					filteredRestaurants.sort(compareRestaurant)
					tableBodyStr = genRestaurantTableStr(filteredRestaurants);
					document.getElementById("restaurantTableBody").innerHTML = tableBodyStr;
				}
				else{
					Restaurants.sort(compareRestaurant)
					tableBodyStr = genRestaurantTableStr(Restaurants);
					document.getElementById("restaurantTableBody").innerHTML = tableBodyStr;
				}
			}
			else{}
		}
		
		document.getElementById("avgPriceInput").onkeyup = function(){
			avgPriceSearch = document.getElementById("avgPriceInput").value;
			if (avgPriceSearch == null){
				document.getElementById("avgPriceInput").classList = "form-control is-invalid";          
				document.getElementById("avgPriceInputFeedback").classList = "invalid-feedback";          
				document.getElementById("avgPriceInputFeedback").innerHTML = "Please give the max average price of the restaurants you want to see";  
			}
			else if (avgPriceSearch <= 0){
				document.getElementById("avgPriceInput").classList = "form-control is-invalid";     
				document.getElementById("avgPriceInputFeedback").classList = "invalid-feedback";          
				document.getElementById("avgPriceInputFeedback").innerHTML = "Be careful! You're entering a price not greater than 0.";
			}
			else {
				document.getElementById("avgPriceInput").classList = "form-control is-valid";     
				document.getElementById("avgPriceInputFeedback").classList = "valid-feedback";          
				document.getElementById("avgPriceInputFeedback").innerHTML = "Valid Price Entered!";
			}
		}
		
		document.getElementById("lastAttendedInput").onchange = function(){
			lastAttendedSearch = document.getElementById("lastAttendedInput").value;
			now = new Date();
			console.log(lastAttendedSearch);
			if (lastAttendedSearch == null){
				document.getElementById("lastAttendedInput").classList = "form-control is-invalid";          
				document.getElementById("lastAttendedInputFeedback").classList = "invalid-feedback";          
				document.getElementById("lastAttendedInputFeedback").innerHTML = "Please give the last attended date of the restaurants you want to see";  
			}
			else if (lastAttendedSearch > (now.getFullYear() + "-" + (now.getMonth()+1) + "-" + now.getDate())){
				console.log("invalid");
				document.getElementById("lastAttendedInput").classList = "form-control is-invalid";     
				document.getElementById("lastAttendedInputFeedback").classList = "invalid-feedback";          
				document.getElementById("lastAttendedInputFeedback").innerHTML = "Be careful! You're entering a date greater than the date today.";
			}
			else {
				document.getElementById("lastAttendedInput").classList = "form-control is-valid";     
				document.getElementById("lastAttendedInputFeedback").classList = "valid-feedback";          
				document.getElementById("lastAttendedInputFeedback").innerHTML = "Valid Date Entered!";
			}
		}
		
		document.getElementById("resetSearchRestaurantPage").onclick = function(){
			initSearchRestaurantPage()
		}
    </script>

</body>
</html>